table(initial_data$analysis_type, initial_data$Na2O)
table(initial_data$analysis_type)
xtabs(~ analysis_type, data = initial_data)
?tapply
tapply(initial_data$SiO2, (initial_data$analysis_type, initial_data$rock_type), FUN=mean)
tapply(initial_data$SiO2, list(initial_data$analysis_type, initial_data$rock_type), FUN=mean)
tapply(initial_data$SiO2, list(initial_data$analysis_type, initial_data$rock_type), FUN=summary)
tapply(initial_data$SiO2, initial_data$analysis_type, FUN=summary)
aggregate(initial_data$SiO2, by = list(initial_data$rock_type), FUN = mean)
aggregate(initial_data$SiO2, by = list(rock_type = initial_data$rock_type), FUN = mean)
aggregate(list(SiO2 = initial_data$SiO2), by = list(rock_type = initial_data$rock_type), FUN = mean)
aggregate(list(SiO2 = initial_data$SiO2, TiO2 = initial_data$TiO2), by = list(rock_type = initial_data$rock_type), FUN = mean)
aggregate(list(SiO2 = initial_data$SiO2, TiO2 = initial_data$TiO2, K2O = initial_data$K2O), by = list(rock_type = initial_data$rock_type), FUN = mean)
export_data <- initial_data[,initial_data$rock_type in c('basalt')]
export_data <- initial_data[,initial_data$rock_type %in% c('basalt')]
export_data
initial_data[, initial_data$rock_type == 'basalt']
initial_data[initial_data$rock_type == 'basalt']
initial_data[initial_data$rock_type == 'basalt', ]
initial_data[initial_data$rock_type %in% c('basalt'), ]
initial_data[initial_data$rock_type %in% c('basalt', 'metadiabase'), ]
export_data <- initial_data[initial_data$rock_type %in% c('basalt', 'metadiabase'), ]
write.csv(export_data, file = 'data/export/basalt_metadiabase.csv', row.names = FALSE)
unlink('readme/day_2/readme_cache', recursive = TRUE)
knit_with_parameters('~/git-repositories/data-science-workshop-2022/readme/day_2/readme.Rmd')
library(tidyverse)
mpg
vignette("tibble")
vignette("ggplo2")
vignette("ggplot2")
vignette("ggplot")
vignette("dplyr")
?vignette
runif(1e3)
runif(10)
tibble(
id = seq(1:5),
rock_name = c("charnockite", "pyroxenite", "dunite", "volynite", "anorthosite"),
is.altered = c(TRUE, FALSE, FALSE, FALSE, FALSE),
)
data.frame(abc = 1, xyz = "a")
data.frame(abc = 1, xyz = "a")$abc
data.frame(abc = 1, xyz = "a")[["abc"]]
data.frame(abc = 1, xyz = "a")[[1]]
df = data.frame(
id = seq(1:5),
rock_name = c("charnockite", "pyroxenite", "dunite", "volynite", "anorthosite"),
is.altered = c(TRUE, FALSE, FALSE, FALSE, FALSE),
)
?data.frame
data.frame(
id = seq(1:5)
)
data.frame(
id = seq(1:5),
rock_name = c("charnockite", "pyroxenite", "dunite", "volynite", "anorthosite"),
is.altered = c(TRUE, FALSE, FALSE, FALSE, FALSE),
)
data.frame(
id = seq(1:5),
rock_name = c("charnockite", "pyroxenite", "dunite", "volynite", "anorthosite")
)
data.frame(
id = seq(1:5),
rock_name = c("charnockite", "pyroxenite", "dunite", "volynite", "anorthosite"),
is.altered = c(TRUE, FALSE, FALSE, FALSE, FALSE)
)
library(readr)
library(knitr)
readr::read_csv('./data/raw_data/mafic_dykes.csv', header=TRUE, sep=',')
?read_csv
readr::read_csv('./data/raw_data/mafic_dykes.csv', delim=',')
readr::read_csv('./data/raw_data/mafic_dykes.csv', col_names=TRUE)
parse_logical()
parse_logical("TRUE")
parse_logical("0")
parse_logical("0", "1")
parse_logical(c("0", "1"))
parse_logical(c("0", "135"))
seq(1:3)
paste(seq(1:3))
paste(seq(1:3), 'f')
paste0(seq(1:3), 'f')
paste0(seq(1:3), '.sample')
tibble(
id = paste0(seq(1:5), '.sample'),
mineral = c('magnetite', 'ilmenite', 'ilmenite', 'Cr-spinel', 'hercynite'),
lab = c('SAV, Banska Bystrica', 'Geological Institute, Bratislava', 'SAV, Banska Bystrica', 'SAV, Banska Bystrica', 'SAV, Banska Bystrica'),
...
)
tibble(
id = paste0(seq(1:5), '.sample'),
mineral = c('magnetite', 'ilmenite', 'ilmenite', 'Cr-spinel', 'hercynite'),
lab = c('SAV, Banska Bystrica', 'Geological Institute, Bratislava', 'SAV, Banska Bystrica', 'SAV, Banska Bystrica', 'SAV, Banska Bystrica')
)
tibble(
id = paste0(seq(1:5), '.sample'),
mineral = c('magnetite', 'ilmenite', 'ilmenite', 'Cr-spinel', 'hercynite'),
lab = c('SAV, Banska Bystrica', 'Geological Institute, Bratislava', 'SAV, Banska Bystrica', 'SAV, Banska Bystrica', 'SAV, Banska Bystrica'),
n_analyses = c(30, 119, 40, 20, 10)
)
c(c('magnetite', 'ilmenite', 'ilmenite', 'Cr-spinel'), 'hercynite')
c(list('magnetite', 'ilmenite', 'ilmenite', 'Cr-spinel'), 'hercynite')
30+50+
tibble(
city = c('Bratislava', 'Banska Bystrica'),
institution = c('SAV', 'Geological Institute'),
minerals = list(list('magnetite', 'ilmenite', 'ilmenite', 'Cr-spinel'), 'hercynite'),
n_analyses = c(119, 100)
)
knitr::opts_chunk$set(echo = TRUE)
tibble(
city = c('Bratislava', 'Banska Bystrica'),
institution = c('SAV', 'Geological Institute'),
minerals = list(list('magnetite', 'ilmenite', 'ilmenite', 'Cr-spinel'), list('hercynite')),
n_analyses = c(119, 100)
)
library(readr)
library(tidyr)
initial_data <- read_xls('./data/raw_data/Chrysoberyl analysis database.xls')
initial_data <- readxl::read_xlsx('./data/raw_data/Chrysoberyl analysis database.xls')
initial_data <- readxl::read_xls('./data/raw_data/Chrysoberyl analysis database.xls')
View(initial_data)
initial_data <- readxl::read_xls('./data/raw_data/Chrysoberyl analysis database.xls')
View(initial_data)
initial_data <- readxl::read_xls('./data/raw_data/Chrysoberyl analysis database.xls')
initial_data
read_xls
?read_xls
initial_data$`analysis 1`
as.numeric(initial_data$`analysis 1`)
?pivot_longer
t
t(initial_data)
tibble(t(initial_data))
as_tibble(t(initial_data))
?as_tibble
transposed = t(initial_data)
View(transposed)
colnames(transposed)
transposed[0]
transposed[1]
transposed[:,1]
transposed[,1]
transposed[1,]
colnames(transposed) = transposed[1,]
View(transposed)
transposed[-1,]
transposed = transposed[-1,]
View(transposed)
initial_data_t <- t(initial_data)
View(initial_data_t)
View(initial_data_t)
initial_data_t <- t(initial_data)[-1,]
View(initial_data_t)
initial_data_t <- t(initial_data)
?pivot_wider
pivot_wider(initial_data_t, names_from=origin)
pivot_wider(initial_data_t, names_from=origin, values_from=SiO2)
View(initial_data_t)
initial_data_t
initial_data_t[1,]
colnames(initial_data_t) <- initial_data_t[1,]
initial_data_t <- initial_data_t[-1,]
pivot_wider(initial_data_t, names_from=origin, values_from=SiO2)
View(initial_data_t)
View(initial_data_t)
pivot_wider(initial_data_t, names_from=Origin, values_from=SiO2)
pivot_wider(initial_data_t, names_from='Origin')
initial_data_t %>%
pivot_wider(Origin, SiO2)
pivot_wider(initial_data_t, names_from=Origin, values_from=SiO2)
initial_data_t
as_tibble(initial_data_t)
initial_data_t <- t(initial_data)
colnames(initial_data_t) <- initial_data_t[1,]
initial_data_t <- as_tibble(initial_data_t[-1,])
pivot_wider(initial_data_t, names_from=Origin, values_from=SiO2)
test = pivot_wider(initial_data_t, names_from=Origin, values_from=SiO2)
View(test)
initial_data_t
initial_data_t <- t(initial_data)
colnames(initial_data_t) <- initial_data_t[1,]
initial_data_t <- as_tibble(initial_data_t[-1,])
initial_data_t[['Origin']]
initial_data_t['Origin']
initial_data_t['Origin', 'SiO2']
initial_data_t[c('Origin', 'SiO2')]
initial_data_t[c('Origin', 'SiO2')] %>%
pivot_wider(Origin, SiO2)
initial_data_t[c('Sample','Origin', 'SiO2')] %>%
pivot_wider(Origin, SiO2)
View(initial_data_t)
View(initial_data)
initial_data_t <- t(initial_data)
View(initial_data_t)
?t
initial_data_t <- t(initial_data)
rownames(initial_data)
initial_data[1,]
initial_data[1,]
initial_data[2,]
initial_data_t[1,]
initial_data_t[2,]
initial_data_t[,1]
initial_data_t[,0]
initial_data_t[0,]
initial_data_t[,0]
initial_data_t[,0]
cbind(nms = names(initial_data), t(initial_data))
names(initial_data)
names(initial_data)
as_tibble(cbind(Sample = names(initial_data), t(initial_data)))
as_tibble(cbind(Sample = names(initial_data), t(initial_data)[1,]))
as_tibble(cbind(Sample = names(initial_data), t(initial_data)[-1,]))
as_tibble(cbind(Sample = names(initial_data), t(initial_data)))
initial_data_t <- t(initial_data)
colnames(initial_data_t) <- initial_data_t[1,]
initial_data_t <- as_tibble(cbind(Sample = names(initial_data), initial_data_t))
initial_data_t
initial_data_t <- t(initial_data)
colnames(initial_data_t) <- initial_data_t[1,]
initial_data_t <- as_tibble(cbind(Sample = names(initial_data), initial_data_t[-1,]))
initial_data_t <- t(initial_data)
colnames(initial_data_t) <- initial_data_t[1,]
as_tibble(cbind(Sample = names(initial_data), initial_data_t[-1,]))
as_tibble(cbind(Sample = names(initial_data)[-1], initial_data_t[-1,]))
piwot_wider(initial_data_t, Origin, SiO2)
pivot_wider(initial_data_t, Origin, SiO2)
initial_data_t
initial_data_t <- t(initial_data)
colnames(initial_data_t) <- initial_data_t[1,]
initial_data_t <- as_tibble(cbind(Sample = names(initial_data)[-1], initial_data_t[-1,]))
initial_data_t
pivot_wider(initial_data_t, Origin, SiO2)
pivot_wider(initial_data_t, names_from=Origin, values_from=SiO2)
pivot_wider(initial_data_t, names_from=Origin, values_from=SiO2, values_fn=min)
pivot_wider(initial_data_t[c('Origin', 'SiO2')], names_from=Origin, values_from=SiO2, values_fn=min)
pivot_wider(initial_data_t[c('Sample', 'Origin', 'SiO2')], names_from=Origin, values_from=SiO2, values_fn=min)
initial_data_t %>%
count()
initial_data_t %>%
count()
library(dplyr)
initial_data_t %>%
count()
initial_data_t %>%
count(Origin)
dim(initial_data)
?select
select(initial_data_t, SiO2)
knitr::opts_chunk$set(echo = TRUE)
```{r}
initial_data_t %>%
select(SiO2)
?dplyr::filter
View(initial_data_t)
initial_data_t
View(initial_data_t)
initial_data_t[-c('Sample', 'Origin', 'Reference')]
initial_data_t[c('Sample', 'Origin', 'Reference')]
initial_data_t[~c('Sample', 'Origin', 'Reference')]
initial_data_t[~c('Sample', 'Origin', 'Reference')]
initial_data_t[!c('Sample', 'Origin', 'Reference')]
initial_data_t[!!c('Sample', 'Origin', 'Reference')]
initial_data %>%
select(c('Sample', 'Origin', 'Reference'))
initial_data_t %>%
select(c('Sample', 'Origin', 'Reference'))
initial_data_t %>%
select(!c('Sample', 'Origin', 'Reference'))
initial_data_t %>%
select(!c('Sample', 'Origin', 'Reference')) %>%
as.numeric()
initial_data_t %>%
select(!c('Sample', 'Origin', 'Reference')) %>%
as.numeric
initial_data_t %>%
select(!c('Sample', 'Origin', 'Reference')) %>%
as.numeric()
as.numeric(initial_data_t)
View(initial_data_t)
initial_data_t %>%
select(!c('Sample', 'Origin', 'Reference')) %>%
mutate_all(as.numeric())
initial_data_t %>%
select(!c('Sample', 'Origin', 'Reference')) %>%
mutate_all(as.numeric)
initial_data_t <- t(initial_data)
colnames(initial_data_t) <- initial_data_t[1,]
initial_data_t
as_tibble(cbind(Sample = names(initial_data)[-1], initial_data_t[-1,]))
initial_data_t[-1,]
as_tibble(initial_data_t[-1,])
initial_data_t <- as_tibble(cbind(Sample = names(initial_data)[-1], initial_data_t[-1,]))
del
rm
rm(test)
rm(transposed)
?as_tibble
initial_data_t %>%
filter(SiO2 > 50)
initial_data_t %>%
filter(as.numeric(SiO2) > 50)
initial_data_t %>%
filter(as.numeric(SiO2) > 50)
View(initial_data_t)
initial_data_t %>%
filter(as.numeric(Al2O3) > 50)
filter(as.numeric(SiO2) > 50)
initial_data_t %>%
filter(Al2O3 > 50)
initial_data_t %>%
filter(Al2O3 > 50 & `BeO calc.` <= 19)
filter(initial_data_t, Al2O3 > 50 & `BeO calc.` <= 19)
View(initial_data_t)
initial_data_t %>% filter(Origin %in% c('Magmatic leucogranite', 'Contaminated ultrabasic rock'))
View(initial_data_t)
View(initial_data_t)
initial_data_t %>% filter(`BeO calc.` >= 20)
initial_data_t %>% filter(`BeO calc.` >= 20 & is.na(Reference))
initial_data_t %>% filter(`BeO calc.` >= 20 & !is.na(Reference))
?desc
unlink("readme/day_2/readme_cache", recursive = TRUE)
?arrange
initial_data_t %>%
arrange(Origin)
initial_data_t %>%
arrange(`BeO calc.`)
initial_data_t %>%
arrange(desc(`BeO calc.`))
View(initial_data_t)
initial_data_t %>%
arrange(`BeO calc.`, TiO2)
initial_data_t %>%
arrange(desc(`BeO calc.`), TiO2)
initial_data_t %>%
arrange(desc(`BeO calc.`), TiO2, Cr2O3)
initial_data_t %>%
arrange(desc(`BeO calc.`), desc(TiO2), desc(Cr2O3))
initial_data_t %>%
slice(5:10)
initial_data_t %>%
slice_head(2)
initial_data_t %>%
slice_head(n=2)
initial_data_t %>%
slice_max(TiO2)
initial_data_t %>%
select(Sample, TiO2, Cr2O3)
initial_data_t %>%
select(Sample, SiO2:TiO2)
View(initial_data_t)
initial_data_t %>%
select(Sample, SiO2:Cr2O3)
initial_data_t %>%
select(Sample, !TiO2:Cr2O3)
initial_data_t %>%
select(starts_with('Si'))
initial_data_t %>%
select(starts_with('Si', 'Ti'))
initial_data_t %>%
select(starts_with(c('Si', 'Ti')))
?ends_with
View(initial_data_t)
initial_data_t %>%
select(!contains('O'))
?matches
initial_data_t %>%
rename(silica = SiO2, alumina = Al2O3)
View(initial_data_t)
initial_data_t %>%
mutate(si_al = SiO2 / Al2O3)
initial_data_t %>%
mutate(si_al = SiO2/Al2O3)
initial_data_t %>%
mutate(si_al = SiO2)
initial_data_t %>%
mutate(si_al = SiO2) %>%
select(sample, si_al)
initial_data_t %>%
mutate(si_al = SiO2) %>%
select(Sample, si_al)
initial_data_t %>%
mutate(si_al = SiO2/TiO2) %>%
select(Sample, si_al)
?mutate
View(initial_data_t)
initial_data_t %>%
mutate(si_al = `BeO calc.`/TiO2)
last_error()
rlang::last_error()
View(initial_data_t)
initial_data_t %>%
mutate(si_al = as.numeric(`BeO calc.`)/as.numeric(TiO2))
initial_data_t %>%
mutate(si_al = as.numeric(`BeO calc.`)/as.numeric(TiO2)) %>%
select(Sample, si_al)
initial_data_t %>%
mutate(be_to_ti = as.numeric(`BeO calc.`)/as.numeric(TiO2)) %>%
select(Sample, si_al)
initial_data_t %>%
mutate(be_to_ti = as.numeric(`BeO calc.`)/as.numeric(TiO2)) %>%
select(Sample, be_to_ti)
initial_data <-readxl::read_xls('./data/raw_data/Chrysoberyl analysis database.xls')
initial_data_t <- t(initial_data)
colnames(initial_data_t) <- initial_data_t[1,]
initial_data_t <- as_tibble(cbind(Sample = names(initial_data)[-1], initial_data_t[-1,]))
initial_data_t
initial_data_t %>%
select(SiO2:)
initial_data_t %>%
mutate_at(!c('Sample', 'Origin', 'Reference'), as.numeric)
?mutate_at
initial_data_t %>%
mutate_at(~c('Sample', 'Origin', 'Reference'), as.numeric)
initial_data_t %>% mutate_at(~c('Sample', 'Origin', 'Reference'), as.numeric)
initial_data_t %>% mutate_at(c('Sample', 'Origin', 'Reference'), as.numeric)
initial_data_t %>% mutate_at(!c('Sample', 'Origin', 'Reference'), as.numeric)
initial_data_t %>% mutate_at(!matches('Sample', 'Origin', 'Reference'), as.numeric)
initial_data_t %>%
mutate_at(-c('Sample', 'Origin', 'Reference'), as.numeric)
initial_data_t %>%
mutate_at(-vars('Sample', 'Origin', 'Reference'), as.numeric)
initial_data_t %>%
mutate_at(c('-Sample'), as.numeric)
initial_data_t %>%
mutate_at(vae('-Sample'), as.numeric)
initial_data_t %>%
mutate_at(vars(-Sample, -Origin, -Reference), as.numeric)
initial_data_t <-
initial_data_t %>%
mutate_at(vars(-Sample, -Origin, -Reference), as.numeric)
View(initial_data_t)
initial_data_t %>%
mutate(be_to_ti = as.numeric(`BeO calc.`)/as.numeric(TiO2))
initial_data_t %>%
mutate(be_to_ti = `BeO calc.`/TiO2)
initial_data_t %>%
mutate(be_to_ti = `BeO calc.`/TiO2) %>%
select(Sample, be_to_ti)
initial_data_t %>%
mutate(ti_to_be = TiO2/`BeO calc.`) %>%
select(Sample, TiO2, ti_to_be)
initial_data_t %>%
mutate(ti_to_be = TiO2/`BeO calc.`) %>%
select(Sample, TiO2, `BeO calc.`, ti_to_be)
initial_data_t %>%
mutate(ti_to_be = TiO2/`BeO calc.`) %>%
select(Sample, TiO2, `BeO calc.`, ti_to_be)
??mutate
??dplyr::mutate
?mutate
initial_data_t %>%
mutate(ti_to_be = TiO2/`BeO calc.`,
ti_to_cr = TiO2/Cr2O3) %>%
select(Sample, TiO2, Cr2O3, `BeO calc.`, ti_to_be, ti_to_cr)
initial_data_t %>%
mutate(ti_to_be = TiO2/`BeO calc.`,
ti_to_cr = Cr2O3/TiO2) %>%
select(Sample, TiO2, Cr2O3, `BeO calc.`, ti_to_be, ti_to_cr)
initial_data_t %>%
mutate(ti_to_be = TiO2/`BeO calc.`,
cr_to_ti = Cr2O3/TiO2) %>%
select(Sample, TiO2, Cr2O3, `BeO calc.`, ti_to_be, cr_to_ti)
initial_data_t %>%
summarise(silica_min = min(SiO2), min_alumina = min(Al2O3))
?summarise
?min
initial_data_t %>%
summarise(silica_min = min(SiO2, na.rm=TRUE), min_alumina = min(Al2O3, na.rm=TRUE))
?replace
View(initial_data_t)
initial_data_t %>%
group_by(Origin) %>%
mutate(ti_to_be = TiO2/`BeO calc.`) %>%
select(Sample, TiO2, `BeO calc.`, ti_to_be)
initial_data_t %>%
group_by(Origin) %>%
summarise(silica_min = min(SiO2, na.rm=TRUE), min_alumina = min(Al2O3, na.rm=TRUE))
initial_data_t %>%
group_by(Origin) %>%
summarise(silica_min = min(SiO2, na.rm=TRUE))
initial_data_t %>%
group_by(Origin) %>%
summarise(silica_min = min(SiO2))
initial_data_t %>%
group_by(Origin) %>%
summarise(silica_min = mean(SiO2))
initial_data_t %>%
group_by(Origin) %>%
summarise(silica_min = mean(`BeO calc.`))
initial_data_t %>%
group_by(Origin) %>%
summarise(be_o_mean = mean(`BeO calc.`))
initial_data_t %>%
group_by(Origin) %>%
mutate(silica_min = mean(`BeO calc.`))
initial_data_t %>%
group_by(Origin) %>%
mutate(mean(`BeO calc.`))
initial_data_t %>%
group_by(Origin) %>%
mutate(silica_min = mean(`BeO calc.`))
initial_data_t %>%
group_by(Origin) %>%
mutate(silica_min = mean(`BeO calc.`))
initial_data_t %>%
summarise(be_o_mean = mean(`BeO calc.`))
initial_data_t %>%
group_by(Origin) %>%
summarise(be_o_mean = mean(`BeO calc.`))
